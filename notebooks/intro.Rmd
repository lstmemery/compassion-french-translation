---
title: "Untitled"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(ggthemes)
```

```{r}
df <- read_csv("../data/Compassion_14 November 2021_16.36.csv", )
```

```{r}
responses <- df %>% 
  select(starts_with("SOCS")) %>% 
  slice(3:n())

responses
```

```{r}
ordered_responses <- responses %>% 
  mutate_all(~if_else(is.na(.), ., str_extract(., "\\d$"))) %>% 
  pivot_longer(everything(), names_to = "item", values_to = "response") %>% 
  mutate(response = ordered(response, levels = c("1", "2", "3", "4", "5")))

ordered_responses
```


```{r, fig.width=16, fig.height=9}
ggplot(ordered_responses, aes(x=response)) +
  geom_bar(stat = "count") +
  facet_wrap(~item, ncol = 10) +
  theme_few()
```
```{r}
devtools::session_info()
```

